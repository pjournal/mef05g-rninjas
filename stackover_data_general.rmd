---
title: "Stack Overflow General Analysis"
author: "RNinjas"
date: "04 12 2021"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(highcharter)
library(sqldf)
library(treemapify)
```

```{r , include=FALSE}

stack_2017=readRDS('C:/Users/Meryem/Documents/stackoverflow_2017.rds')
stack_2018=readRDS('C:/Users/Meryem/Documents/stackoverflow_2018.rds')
stack_2019=readRDS('C:/Users/Meryem/Documents/stackoverflow_2019.rds')
stack_2020=readRDS('C:/Users/Meryem/Documents/stackoverflow_2020.rds')
stack_2021=readRDS('C:/Users/Meryem/Documents/stackoverflow_2021.rds')

stackover_full <- rbind(stack_2017, stack_2018,stack_2019,stack_2020,stack_2021)

```

## General Information About Data

*stackover_full* includes the last 5 years stack overflow survey results. This data consist of 342 variable and 387030 observations.

When the number of participants by years is examined

```{r stackoverflow2}
stackover_full%>%group_by(Year)%>%count()
```

### Participant's Country  Analysis
The survey participants have different countries.

That there are looking at the unique value of countries, same country name spelled differently such as "United States" vs "United States of America".
This type of data should be converted.

```{r country1}
head(unique(stackover_full$Country),20)
```


```{r country2}
stackover_full=stackover_full%>% 
  mutate(Country=case_when(Country=="United States of America" ~ "United States",
                           Country=="United Kingdom of Great Britain and Northern Ireland" ~"United Kingdom",
                           Country=="Viet Nam" ~"Vietnam",
                           Country=="Iran, Islamic Republic of..." ~"Iran",
                           Country=="Congo, Republic of the..." ~"Democratic Republic of the Congo",
                           Country=="Venezuela, Bolivarian Republic of..." ~"Venezuela",
                           Country=="Dominican Republic" ~"Dominica",
                           Country=="The former Yugoslav Republic of Macedonia" ~"Macedonia",
                           Country=="Libyan Arab Jamahiriya" ~"Libya",
                           Country=="Slovak Republic" ~"Slovakia",
                           Country=="Azerbaidjan" ~"Azerbaijan",
                           Country=="Tadjikistan" ~"Tajikistan",
                           Country=="Syrian Arab Republic" ~"Syria",
                           Country=="Democratic People's Republic of Korea" ~"North Korea",
                           Country=="Republic of Korea" ~"South Korea",
                           Country=="United Republic of Tanzania" ~"Tanzania",
                           Country=="Hong Kong (S.A.R.)" ~"Hong Kong",
                           Country=="" ~"Not Responding",
                           Country=="I prefer not to say" ~"Not Responding",
                           TRUE ~Country))

```

After data cleaning according to Country, 

Let see the distirbution participants.

```{r country3}
countrydist=stackover_full%>% 
  group_by(Country) %>%
  count()%>%
  arrange(desc(Country))

countrydist
```


Some country participant count is very low, so these data's are eliminated. 

Countries with a below-average number of participants were excluded from the analysis.

So, mean of participant count is 1653.974. After elimination, ```countrydist_elimination``` data frame have 44 countries that have above-average number of participants.

Most of the participants are from United States, India, Germany, United Kingdom	 and Canada.

```{r countrydist_elimination}
countrydist_elimination=countrydist %>%
  mutate(avg=mean(countrydist$n)) %>%
  filter(n>avg) %>%
  select(Country,n)%>%
  arrange(desc(n))

countrydist_elimination
```

Let see the graph number of participants by top 10 country.

```{r country_graph}
countrydist_graph=countrydist %>%
  mutate(avg=mean(countrydist$n)) %>%
  filter(n>avg) %>%
  select(Country,n)%>%
  arrange(desc(n)) %>%
  head(15)


ggplot(countrydist_graph, 
       aes(fill = Country, 
           area = n, 
           label = Country)) +
  geom_treemap() + 
  geom_treemap_text(colour = "white", 
                    place = "centre") +
  labs(title = "Country Distribution") +
  theme(legend.position = "none")

```

### Participant's Branch Analysis
The survey participants have different branches.
That there are looking at the unique value of branches:

```{r mainBranch1}
unique(stackover_full$MainBranch)
```

There are 6 unique branches. But since the response of the survey to this variable changes over the years, some values need to be converted.
For example "I am a developer by profession"  is the same as "Professional developer".

11 different categories reduced to 5 categories by doing the following conversion.
```{r mainBranch2}
stackover_full=stackover_full%>% 
  mutate(MainBranch=case_when(MainBranch=="I am a developer by profession" ~ "Professional developer",
                              MainBranch=="Used to be a professional developer" ~ "Professional developer",
                              MainBranch=="I used to be a developer by profession, but no longer am" ~ "Professional developer",
                              MainBranch=="I am a student who is learning to code" ~"Student",
                              MainBranch=="Professional non-developer who sometimes writes code" ~ "Hobby",
                              MainBranch=="I code primarily as a hobby" ~ "Hobby",
                              MainBranch=="I am not primarily a developer, but I write code sometimes as part of my work" ~"Sometimes Coding",
                              MainBranch=="" ~"None of these",
                              TRUE ~MainBranch))

unique(stackover_full$MainBranch)
```

Looking at the distribution of categories over all participants:

Stackoverflow is used by professional developers by %54.

```{r mainBranch3}
mainbranchdist=stackover_full%>%
  group_by(MainBranch)%>%
  count()%>%
  mutate(perc_n=round(n/NROW(stackover_full)*100,2))%>%
  arrange(desc(n))
mainbranchdist
```

The branch of the participants' distribution chart:

```{r mainbranchchart}
hchart(mainbranchdist,hcaes(x=MainBranch,y=perc_n),type="column",name="Percentage",color="#80FF40") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Distrubition of Participants",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
```


### Participant's Age  Analysis

This site is used by people from different age groups.
By looking at the age distribution of the participants, it can be determined which age range is used more actively.

```{r age1}
unique(stackover_full$Age)
```

Considering the age values, there is a need for regrouping.

```{r age2}
stackover_full=stackover_full%>%
  mutate(Age=gsub(" years old", "", tolower(Age))) %>%
  mutate(Age=gsub(" - ", "-", tolower(Age))) %>%
  mutate(Age=case_when(Age=="" ~"Prefer not to say",Age=="prefer not to say" ~"Prefer not to say",TRUE ~Age))

unique(stackover_full$Age)

```

When the age distribution by years is investigated:

```{r agedist}
agedist=stackover_full %>%
  group_by(Year,Age) %>%
  count() %>%
  arrange(desc(Year,Age))

agedist

```


Since the participants did not specify their ages in 2017, no inference can be made for this year.

When the graph is examined, it can be said that the 24-34 age range is actively using stackoverflow.

In recent years, it has been seen that the "18-24" and "under 18" age group uses stackoverflow more.
In this way, it can be said that there is a tendency towards programming in the younger generation.


```{r agedistchart}

highchart() %>% 
  hc_add_series(agedist, type = "bar", hcaes(x = Year, group = Age, y = n)) %>% 
  hc_xAxis(categories = agedist$Age)


```


### Participant's Education Level  Analysis

When the education levels of the participants are examined, 21 different categories are in data.
Actually, some categories are the same. But it seems different due to missing punctuation marks or spelling. For example "Master’s degree (MA, MS, M.Eng., MBA, etc.)" is the same "Master’s degree (M.A., M.S., M.Eng., MBA, etc.)", only punctuation marks are different.


```{r edlevel1}
unique(stackover_full$EdLevel)
```


This data should be rearrange .

After data cleaning process, 21 different education level responses were reduced to 13.

```{r edlevel2}

stackover_full$EdLevel=gsub("\\([^)]*)", "",stackover_full$EdLevel)
stackover_full$EdLevel=gsub("degree ","degree",stackover_full$EdLevel)
stackover_full$EdLevel=gsub("’","'",stackover_full$EdLevel)
stackover_full$EdLevel=gsub("without earning a bachelor's degree","without earning a degree",stackover_full$EdLevel)
stackover_full$EdLevel=gsub("school ","school",stackover_full$EdLevel)
unique(stackover_full$EdLevel)

```

These values were re-categorized according to the level of education.

```{r edlevel3}

stackover_full=stackover_full %>% 
  mutate(EdLevel_Bucket=case_when(EdLevel %in% c("Secondary school","Primary/elementary school","Something else")~1,
                                  EdLevel %in% c("Associate degre","Bachelor's degree")~2,
                                  EdLevel %in% c("Doctoral degree","Master's degree","Other doctoral degree","Professional degree")~3,
                                  EdLevel %in% c("I never completed any formal education","Some college/university study without earning a degree")~4,
                                  EdLevel %in% c("I prefer not to answer","")~5,
                                  TRUE ~6))


edleveldist=stackover_full%>%group_by(Year,EdLevel_Bucket)%>%count()
```

When the graph is examined, Stack Overflow mostly is used by people that have *Associate degree* or *Bachelor's degree*.

```{r edlevelchart}

highchart() %>% 
  hc_add_series(edleveldist, type = "bar", hcaes(x = Year, group = EdLevel_Bucket, y = n)) %>% 
  hc_xAxis(categories = edleveldist$EdLevel_Bucket)


```